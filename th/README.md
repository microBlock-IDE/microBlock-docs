# เริ่มต้นใช้งาน microBlock IDE

microBlock IDE เป็นเครื่องมือที่ใช้เขียนโปรแกรมสั่งงานไมโครคอนโทรลเลอร์ด้วยภาษาบล็อก หรือภาษาไพทอน พัฒนาขึ้นด้วยหลักการสำคัญ 4 ประการ

  1. ง่ายต่อการใช้งาน
  2. ยืดหยุ่นมากพอให้สามารถต่อยอดได้
  3. ใช้งานได้กับอุปกรณ์ที่หลากหลาย
  4. Open source

## อุปกรณ์ที่สามารถใช้งานได้

microBlock IDE ทำหน้าที่แปลงจากภาษาบล็อกเป็นภาษาไพทอน จากนั้นอัพโหลดโค้ดโปรแกรมภาษาไพทอนลงไปในอุปกรณ์ที่มี MicroPython ติดตั้งอยู่ก่อนแล้ว ดังนั้นอุปกรณ์ที่สามารถใช้กับ MicroPython ได้ ก็สามารถใช้งานกับ microBlock IDE ได้

ปัจจุบัน MicroPython รองรับการติดตั้งบนอุปกรณ์ดังนี้

  1. ESP32 (แนะนำ) ไมโครคอนโทรลเลอร์พร้อม WiFi และบลูทูธ
  2. ESP8266 ไมโครคอนโทรลเลอร์พร้อม WiFi
  3. STM32 ไมโครคอนโทรลเลอร์

การติดตั้ง MicroPython แตกต่างกันในแต่ละอุปกรณ์ ตัวอย่างในบทความนี้ใช้บอร์ด IOXESP32PS ซึ่งเป็นบอร์ดพัฒนา ESP32 พร้อม PSRAM 4MB

> สั่งซื้อบอร์ด IOXESP32PS เพื่อให้ microBlock ได้รับการพัฒนาอย่างต่อเนื่องได้ที่ ....

## การติดตั้ง MicroPython

การติดตั้ง MicroPython ลงบอร์ด ESP32 สามารถเลือกใช้โปรแกรมอัพโหลดเฟิร์มแวร์ให้ ESP32 ได้หลายตัว เช่น esptool , Flash Download Tools แต่สำหรับบทความนี้แนะนำโปรแกรม MicroUploader ซึ่งเป็นโปรแกรมใช้อัพโหลดเฟิร์มแวร์ MicroPython โดยเฉพาะ พัฒนาโดย microBlock IDE

ดาวน์โหลดโปรแกรม MicroUploader ได้ที่ https://github.com/microBlock-IDE/MicroUploader/releases/ แล้วเปิดโปรแกรมโดยดับเบิลคลิกไฟล์ MicroUploader ขึ้นมา

การใช้งานโปรแกรมมี 4 ขั้นตอน ดังนี้

  1. เลือกบอร์ด - กรณีไม่มีบอร์ดที่ท่านใช้งานอยู่ให้เลือก ให้พิจารณาว่าบอร์ด ESP32 ของท่านมี PSRAM หรือไม่ หากมีให้เลือก ESP32 Wrover Moduleหากไม่มี PSRAM ให้เลือก ESP32 Dev Module 
  2. เลือกพอร์ต - โปรแกรมจะแสดงรายการพอร์ตทั้งหมดขึ้นมา กรณีไม่มีพอร์ตให้เลือกเลย ให้ตรวจสอบว่าสาย MicroUSB เป็นสายแบบ Data ขึ้นไม่ (สายชาร์จอย่างเดียวใช้ไม่ได้) และตรวจสอบว่าได้ลงไดร์เวอร์แล้วหรือยัง
  3. เลือกเวอร์ชั่นของ MicroPython - แนะนำให้เลือกเวอร์ชั่นล่าสุด
  4. กดอัพโหลดโปรแกรม

> การใช้งานโปรแกรมจะต้องทำตามขั้นตอน 1 ถึง 4 เรียงกันเท่านั้น

หลังอัพโหลดโปรแกรมเสร็จเรียบร้อย จะมีข้อความแสดง .... (ดังรูป)

## เปิดใช้งาน Serial API

microBlock IDE เป็นเว็บแอพพลิเคชั่นที่จำเป็นจะต้องเข้าถึงอุปกรณ์ต่าง ๆ ที่เชื่อมต่อกับเครื่องคอมพิวเตอร์ผ่าน API และการเชื่อมต่อกับบอร์ด ESP32 ผ่าน USB นั้นจำเป็นต้องใช้ Serial API ซึ่งปัจจุบันมีเฉพาะโปรแกรม Google Chrome เท่านั้นที่สามารถใช้งานได้ และจำเป็นต้องเปิดใช้ Serial API ด้วย

การเปิดใช้งาน Serial API ให้เข้าไปที่ chrome://flags จากนั้นค้นหา #enable-experimental-web-platform-features แล้วกดปุ่มเปิดใช้งาน เป็นอันเสร็จสิ้นขั้นตอนการเปิดใช้ Serial API

## เขียนโปรแกรมแรก ไฟกระพริบ

เริ่มต้นให้เข้าไปที่ microblock.app จะพบกับหน้าต่างของ microBlock IDE ประกอบด้วย 4 ส่วนสำคัญและ 1 ส่วนเพิ่มเติมดังนี้

  1. เมนูส่วนบน - ประกอบด้วย
     1. สวิตช์เลือกโหมดใช้งาน - microBlock IDE รองรับการใช้งาน 2 โหมด คือโหมดบล็อกและโหมดโค้ด สามารถกดสวิตช์ที่ส่วนนี้เพื่อปรับโหมดการใช้งานได้
     2. ปุ่มเปิดหน้าต่างส่วนเสริม - กดปุ่มเพื่อจัดการส่วนเสริมในโปรเจค
     3. ปุ่มช่วยเหลือ - เป็นปุ่มที่กดแล้วจะพาเข้าสู่เว็บไซต์หลักเพื่อแนะนำ microBlock IDE และแนะนำการใช้งาน
  2. เมนูหมวดหมู่บล็อก - ประกอบด้วย
     1. Pin - บล็อกที่เกี่ยวข้องกับการจัดการ I/O
     2. Control - บล็อกที่เกี่ยวข้องกับการจัดการลำดับการทำงานของโปรแกรม
     3. Operators - บล็อกเกี่ยวกับการคำนวณและเงื่อนไข
     4. Variables - บล็อกตัวแปร
     5. Function - บล็อกฟังก์ชั่น
     6. Advanced - บล็อกเกี่ยวกับการใช้งานขั้นสูง
  3. พื้นที่ทำงาน - เป็นส่วนที่ใช้ลากบล็อกมาวางเพื่อเขียนโปรแกรมด้วยบล็อก
  4. เมนูส่วนล่าง - ประกอบด้วย
     1. ปุ่มสร้างโปรเจคใหม่
     2. ปุ่มบันทึกโปรเจค
     3. ปุ่มเปิดโปรเจค
     4. ปุ่มอัพโหลด
     5. ปุ่มเปิด Terminal
  5. Terminal - เป็นส่วนที่ใช้เขียนพิมพ์คำสั่งติดต่อกับ MicroPython บนบอร์ด ESP32 โดยตรง ใช้ตรวจสอบการทำงานของโปรแกรมว่ามีความผิดพลาดอะไรเกิดขึ้นหรือไม่ และใช้ดูค่าที่ได้จากการใช้บล็อก print

โปรแกรมไฟกระพริบมีหลักการทำงาน คือ ไฟติดค้างระยะเวลาหนึ่ง แล้วไฟดับค้างระยะเวลาหนึ่ง แล้วติด แล้วดับ เป็นแบบนี้ไปเรื่อย ๆ จากหลักการดังกล่าวจำเป็นต้องใช้บล็อกดังนี้

  1. บล็อก digital write - ใช้สั่งให้หลอดไฟติดหรือดับ อยู่ในหมวดหมู่ Pin
  2. บล็อก wait ... sec - ใช้สั่งให้หยุดการทำงานตามเวลาที่กำหนด (กรณีนี้ใช้ทำให้ไฟติดค้าง หรือดับค้าง) อยู่ในหมวดหมู่ Control
  3. บล็อก forever - ใช้ใส่โปรแกรมที่ต้องการให้ทำงานซ้ำ ๆ กรณีนี้คือใช้ใส่บล็อกที่ทำให้ไฟติดแล้วดับ อยู่ในหมวดหมู่ Control

เมื่อทราบว่าจะต้องใช้บล็อกใดบ้างแล้ว ขั้นตอนต่อมาคือลากบล็อกออกมาจากหมวดหมู่ แล้วต่อบล็อกตามลำดับดังนี้

1) คลิกที่เมนู Pin จากนั้นคลิกเม้าส์ค้างที่บล็อก digital write จากนั้นลากมาใส่ในพื้นที่ทำงาน

2) คลิกที่เมนู Control ลากบล็อก wait ... sec ออกมา ต่อกับบล็อก digital write ที่ลากออกมาก่อนหน้านี้

3) คลิกขวาที่ digital write จากนั้นกด Duplicate ลากบล็อก digital write ไปต่อกับบล็อกก่อนหน้านี้

4) คลิกขวาที่ wait ... sec จากนั้นกด Duplicate ลากบล็อก wait ... sec ไปต่อกับบล็อกก่อนหน้านี้

โปรแกรมที่ได้เป็นไฟกระพริบแล้ว แต่ไฟกระพริบนี้ทำงานครั้งเดียว เพื่อให้ไฟกระพริบตลอดเวลา จำเป็นต้องใช้บล็อก forever เข้ามาทำให้ไฟกระพริบตลอดเวลา

5) คลิกที่เมนู Control ลากบล็อก forever ออกมา นำบล็อกที่มีอยู่แล้ว นำไปใส่ใน forever

คลิกที่ปุ่มอัพโหลด การอัพโหลดในครั้งแรก Google Chrome จะให้เลือกพอร์ตของบอร์ด หลังจากเลือกพอร์ตแล้ว โปรแกรมจะเริ่มอัพโหลดลงบอร์ด รอจนกว่าอัพโหลดโปรแกรมเสร็จ แล้วโปรแกรมจะเริ่มทำงานทันที

## ปัญหาที่พบบ่อย

เขียนโปรแกรมถูกแล้ว แต่โปรแกรมไม่ทำงาน หรือทำงานไม่ถูกต้อง

>เปิด Terminal ขึ้นมา จากนั้นอัพโหลดโปรแกรมซ้ำลงไป หากพบ Error และมั่นใจว่าโปรแกรมถูกต้องแล้ว ให้ลอง Reset บอร์ดดูก่อน

จะใช้งาน microBlock IDE ต้องลงโปรแกรมอะไรบ้าง

>microBlock IDE เป็นบริการบนเว็บ ท่านสามารถใช้งาน microBlock IDE ได้เลยโดยไม่ต้องลงโปรแกรมเพิ่ม แต่ต้องใช้ microBlock IDE กับ Google Chrome เท่านั้น และเปิดใช้งาน Serial API

บล็อกที่ต้องการใช้งานไม่มี จะต้องทำอย่างไร

>microBlock IDE สามารถลงบล็อกเสริมที่เรียกว่า Extension ได้ โดยท่านสามารถกดปุ่มเปิดหน้าต่างส่วนเสริมขึ้นมา แล้วกดติดตั้งส่วนเสริมที่ต้องการได้เลย

microBlock IDE ใช้งานได้กับบอร์ดอะไรบ้าง

>microBlock IDE จะช่วยแปลงบล็อกเป็นโค้ดโปรแกรม Python ให้ จากนั้นจึงอัพโหลดโค้ดโปรแกรมลงไปบนบอร์ดที่ติดตั้ง MicroPython แล้ว ดังนั้น microBlock IDE จึงใช้ได้กับทุกบอร์ดที่ลง MicroPython ได้

## ติดต่อสอบถามและรายงานปัญหา

ท่านสามารถเปิด issues ที่หน้า GitHub ของโปรเจค microBlock IDE ได้ที่ https://github.com/microBlock-IDE/microBlock-IDE/issues หรือติดต่อ 084 107 9779 (13.00 - 16.00 น.)
